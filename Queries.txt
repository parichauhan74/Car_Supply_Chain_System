
--1. Give the name of the plant head where the Car model ‘Accelero Voyager’ is produced. 
SELECT DISTINCT PH.H_NAME AS Plant_Head_Name 
FROM PLANT_HEAD PH 
JOIN PLANT_PRODUCES PP ON PH.PLANT_NO = PP.PLANT_NO 
JOIN CAR_MODEL CM ON PP.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE CM.MODEL_NAME = 'Accelero Voyager'; 


--2. Give the name and id of the supplier who supplies both ‘brake pad and tiers’. 
SELECT s.SUPPLIER_ID,s.SUPPLIER_NAME 
FROM SUPPLIER s 
JOIN SUPPLIES_PARTS sp1 ON s.SUPPLIER_ID = sp1.SUPPLIER_ID 
JOIN SUPPLIES_PARTS sp2 ON s.SUPPLIER_ID = sp2.SUPPLIER_ID 
JOIN PARTS p1 ON sp1.PART_ID = p1.PART_ID 
JOIN PARTS p2 ON sp2.PART_ID = p2.PART_ID 
WHERE p1.PART_NAME = 'Brake Pads' 
AND p2.PART_NAME = 'Tires'; 


--3. Give customer ID and name who purchases car which has worth more than 24 lakhs 
(including the discount). 
SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, (ST.CAR_AMOUNT - ST.DISCOUNT_AMOUNT) AS 
PAID_AMOUNT 
FROM SELLS_TO ST 
JOIN CUSTOMER C ON ST.CUSTOMER_ID = C.CUSTOMER_ID 
WHERE (ST.CAR_AMOUNT - COALESCE(ST.DISCOUNT_AMOUNT, 0)) > 2400000; 


--4. Give the total amount paid by manufacturer by ordering parts from Gujarat for all the 
cars. 
SELECT SUM(ot.TOTAL_AMOUNT) AS TOTAL_AMOUNT_PAID 
FROM ORDER_TRANSACTIONS ot 
JOIN ORDER_OF_MANUFACTURER om ON ot.ORDER_NO = om.ORDER_NO 
JOIN MANUFACTURER m ON om.M_ID = m.M_ID 
WHERE m.COUNTRY = 'India' AND m.STATE = 'Gujarat' 


--5. Find out the average selling price of cars by dealers to customers. 
SELECT SUM(st.car_amount - st.DISCOUNT_AMOUNT) / COUNT(*) AS 
average_selling_price 
FROM SELLS_TO st; 


--6. Find the ID and name of the dealer who sold the most expensive car. 
SELECT s.DEALER_ID, d.DEALER_NAME 
FROM SELLS_TO s 
JOIN DEALER d ON s.DEALER_ID = d.DEALER_ID 
JOIN ( 
SELECT MAX(CAR_AMOUNT) AS MAX_CAR_AMOUNT  
FROM SELLS_TO 
) max_amt ON s.CAR_AMOUNT = max_amt.MAX_CAR_AMOUNT; 


--7. Find the name and ID of car models that do not pass all the tests along with the name of 
the test which the car fails to pass. 
SELECT cm.CAR_MODEL_ID, cm.MODEL_NAME, ct.TEST_NAME 
FROM CAR_MODEL cm 
JOIN CAR_TEST ct ON cm.CAR_MODEL_ID = ct.CAR_MODEL_ID 
WHERE (cm.CAR_MODEL_ID, ct.TEST_NAME) NOT IN ( 
SELECT CAR_MODEL_ID, TEST_NAME 
FROM CAR_TEST 
WHERE RESULT = 'Y' 
); 


--8. Calculate Total revenue of dealer generated by selling Accelero Avant 
SELECT SUM(ST.CAR_AMOUNT-ST.DISCOUNT_AMOUNT) AS TOTAL_REVENUE 
FROM SELLS_TO ST 
JOIN CAR_MODEL CM ON ST.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE CM.MODEL_NAME = 'Accelero Avant'; 


--9. Give the list of Suppliers with name and ID who do not outsource parts from any other 
suppliers (i.e., they directly supply to the manufacturer). 
SELECT DISTINCT s.SUPPLIER_NAME,s.SUPPLIER_ID 
FROM SUPPLIER s 
WHERE s.SUPPLIER_ID NOT IN ( 
SELECT DISTINCT ORDERING_SUPPLIER 
FROM ORDERS_OF_SUPPLIER 
); 


--10. Find the plant number which produced most no of cars before 2022-12-31 also give qty 
of cars. 
SELECT PLANT_NO, COUNT(*) AS TOTAL_CARS_PRODUCED 
FROM PLANT_PRODUCES 
WHERE END_DATE <= '2022-12-31' 
GROUP BY PLANT_NO 
ORDER BY TOTAL_CARS_PRODUCED DESC 
LIMIT 1; 


--11. Calculate state-wise cars sold by dealer. 
SELECT C.STATE, COUNT(DISTINCT OBO.CAR_MODEL_ID) AS "Number of Car Models Sold" 
FROM ORDER_OF_MANUFACTURER OOM 
JOIN ORDER_BASED_ON OBO ON OOM.ORDER_NO = OBO.ORDER_NO 
JOIN CAR_MODEL CM ON OBO.CAR_MODEL_ID = CM.CAR_MODEL_ID 
JOIN SELLS_TO ST ON CM.CAR_MODEL_ID = ST.CAR_MODEL_ID 
JOIN CUSTOMER C ON ST.CUSTOMER_ID = C.CUSTOMER_ID 
GROUP BY C.STATE; 


--12. Give the name and Id of the most profitable dealer for manufacture 
SELECT d.DEALER_ID, d.DEALER_NAME, SUM(dof.TOTAL_AMOUNT) AS TOTAL_SALES_AMOUNT 
FROM DEALER d 
JOIN DEALER_ORDER_FOR dof ON d.DEALER_ID = dof.DEALER_ID 
WHERE d.DEALS_WITH_M_ID = 'M01' 
GROUP BY d.DEALER_ID, d.DEALER_NAME 
ORDER BY TOTAL_SALES_AMOUNT DESC 
LIMIT 1; 


--13. Calculate  how many order required for car_model_id CM1. 
SELECT COUNT(*) AS order_count 
FROM ORDER_BASED_ON 
WHERE car_model_id = 'CM1'; 


--14. From duration of January 2023 to March 2024 give how many order of seats done by 
manufacturer and also give the total money spent on it. 
SELECT SUM(CAST(OFp.QUANTITY AS INTEGER)) AS TOTAL_QUANTITY_ORDERED, 
SUM(CAST(OFp.QUANTITY AS INTEGER) * P.UNIT_PRICE) AS TOTAL_PRICE 
FROM ORDER_FOR_PARTS OFp 
JOIN ORDER_OF_MANUFACTURER OOM ON OFp.ORDER_NO = OOM.ORDER_NO 
JOIN PARTS P ON OFp.PART_ID = P.PART_ID 
WHERE P.PART_NAME = 'Car Seats' 
AND OOM.PLACING_DATE >= DATE '2023-01-01' 
AND OOM.PLACING_DATE < DATE '2024-04-01';  


--15. Provide the number of cars are sold in 2023 by each car model name. 
SELECT CAR_MODEL.MODEL_NAME, COUNT(*) AS TotalSales 
FROM SELLS_TO 
JOIN CAR_MODEL ON SELLS_TO.CAR_MODEL_ID = CAR_MODEL.CAR_MODEL_ID 
WHERE EXTRACT(YEAR FROM SELLS_TO.SELLING_DATE) = 2023 
GROUP BY CAR_MODEL.MODEL_NAME 
ORDER BY TotalSales DESC; 


--16. Give the plant head name and contact no for plant which is located in ‘Chennai’. 
SELECT PH.H_NAME AS PLANT_HEAD_NAME, PH.CONTACT_NO AS PLANT_HEAD_CONTACT 
FROM ASSEMBLY_PLANT AP 
JOIN PLANT_HEAD PH ON AP.PLANT_NO = PH.PLANT_NO 
WHERE AP.CITY = 'Chennai'; 


--17. Give car model name which has highest milage in kmpl. 
SELECT DISTINCT MODEL_NAME, MILEAGE_IN_KMPL AS HighestMileage 
FROM CAR_MODEL 
WHERE MILEAGE_IN_KMPL = ( 
SELECT MAX(MILEAGE_IN_KMPL) 
FROM CAR_MODEL 
); 


--18. Give the VIN, car model id and car model name which is purchased by PM Jat in Goa. 
SELECT SM.CAR_MODEL_ID, CM.MODEL_NAME, R.VIN 
FROM SELLS_TO SM 
JOIN CUSTOMER C ON SM.CUSTOMER_ID = C.CUSTOMER_ID 
JOIN RTO R ON SM.REGISTRATION_NO = R.REGISTRATION_NO 
JOIN CAR_MODEL CM ON SM.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE C.CUSTOMER_NAME = 'PM Jat' 
AND C.STATE = 'Goa'; 


--19. Give name of the car model and car model which are made before 2022. 
SELECT CM.MODEL_NAME, COUNT(*) AS TotalProduced 
FROM CAR_MODEL CM 
INNER JOIN PLANT_PRODUCES PP ON CM.CAR_MODEL_ID = PP.CAR_MODEL_ID 
WHERE PP.END_DATE <= '2022-12-31'  
GROUP BY CM.MODEL_NAME; 


--20. Give the name , ID and Start date – End date of insurance of the car model which is 
purchased by ‘Vijay Reddy’. 
SELECT SM.CAR_MODEL_ID, CM.MODEL_NAME, I.START_DATE AS INSURANCE_START_DATE, 
I.END_DATE AS INSURANCE_END_DATE 
FROM SELLS_TO SM 
JOIN CUSTOMER C ON SM.CUSTOMER_ID = C.CUSTOMER_ID 
JOIN INSURANCE I ON C.CUSTOMER_ID = I.CUSTOMER_ID 
JOIN CAR_MODEL CM ON SM.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE C.CUSTOMER_NAME = 'Vijay Reddy'; 


--21.Give the name of the supplier who provide component material, also give a list of the components that they provide. 
SELECT S.SUPPLIER_NAME, P.PART_NAME 
FROM SUPPLIER S 
JOIN SUPPLIES_PARTS SP ON S.SUPPLIER_ID = SP.SUPPLIER_ID 
JOIN PARTS P ON SP.PART_ID = P.PART_ID 
WHERE S.SUPPLIER_TYPE = 'C'; 


--22.Give the supplier name and type who provides parts to another supplier and also give the part name which he supplies.
SELECT DISTINCT  
s1.supplier_name AS providing_supplier_name,  
s1.supplier_type AS providing_supplier_type, 
s2.supplier_name AS ordering_supplier_name,  
p.part_name 
FROM  
orders_of_supplier os 
JOIN  
supplier s1 ON os.providing_supplier = s1.supplier_id 
JOIN  
supplier s2 ON os.ordering_supplier = s2.supplier_id 
JOIN  
parts p ON os.ordered_part_id = p.part_id 


--23. Give plant head name, contact no, and car model name for which car is not ready to sell. 
SELECT DISTINCT PH.H_NAME AS PLANT_HEAD_NAME, PH.CONTACT_NO, CM.MODEL_NAME AS 
CAR_MODEL_NAME 
FROM PLANT_PRODUCES PP 
JOIN PLANT_HEAD PH ON PP.PLANT_NO = PH.PLANT_NO 
JOIN CAR_MODEL CM ON PP.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE PP.END_DATE IS NULL; 


--24. Give the name and receiving date of the part which is ordered in March 2022. 
SELECT P.PART_NAME, OM.RECEIVING_DATE,OM.PLACING_DATE as ordering_date 
FROM ORDER_FOR_PARTS O 
JOIN PARTS P ON O.PART_ID = P.PART_ID 
JOIN ORDER_OF_MANUFACTURER OM ON O.ORDER_NO = OM.ORDER_NO 
WHERE EXTRACT(YEAR FROM OM.PLACING_DATE) = 2022 
AND EXTRACT(MONTH FROM OM.PLACING_DATE) = 3;   


--25. Give the ID, name of car model which was produced in the least time and also provide its production start date and end date and the plant number where it is produced. 
SELECT  
PP.PLANT_NO,  
CM.CAR_MODEL_ID,  
CM.MODEL_NAME,  
PP.START_DATE,  
PP.END_DATE, 
(PP.END_DATE - PP.START_DATE) AS DURATION_DAYS 
FROM  
PLANT_PRODUCES PP 
JOIN  
CAR_MODEL CM ON PP.CAR_MODEL_ID = CM.CAR_MODEL_ID 
ORDER BY  
DURATION_DAYS ASC 
LIMIT 5; 
 

--26. Give Top 3 dealer’s ID, name and qty of the cars ordered which were ordered from manufacturer between 2022-2023. 
 
SELECT  
    don.DEALER_ID, 
    D.DEALER_NAME, 
    COUNT(*) AS TOTAL_ORDERS 
FROM  
    DEALER_ORDER_FOR AS don 
JOIN  
    DEALER AS D ON don.DEALER_ID = D.DEALER_ID 
WHERE  
    EXTRACT(YEAR FROM don.ORDERING_DATE) BETWEEN 2022 AND 2023 
GROUP BY  
    don.DEALER_ID, 
    D.DEALER_NAME 
ORDER BY  
    TOTAL_ORDERS DESC 
LIMIT 3; 
 

--27. Find car model ID which has the highest cost to make it. 
 
 WITH TotalCostPerCarModel AS ( 
    SELECT OB.CAR_MODEL_ID, SUM(OT.TOTAL_AMOUNT) AS TOTAL_COST 
    FROM ORDER_BASED_ON OB 
    JOIN ORDER_TRANSACTIONS OT ON OB.ORDER_NO = OT.ORDER_NO 
    GROUP BY OB.CAR_MODEL_ID 
) 
SELECT CM.CAR_MODEL_ID, CM.MODEL_NAME, TC.TOTAL_COST 
FROM TotalCostPerCarModel TC 
JOIN CAR_MODEL CM ON TC.CAR_MODEL_ID = CM.CAR_MODEL_ID 
ORDER BY TC.TOTAL_COST DESC 
LIMIT 1; 
 

--28. Give supplier ID and name who provides engine. 
 
 SELECT  
    S.SUPPLIER_ID, 
    S.SUPPLIER_NAME 
FROM  
    SUPPLIER S 
JOIN  
    SUPPLIES_PARTS SP ON S.SUPPLIER_ID = SP.SUPPLIER_ID 
JOIN  
    PARTS P ON SP.PART_ID = P.PART_ID 
WHERE  
    P.PART_NAME = 'engine'; 
 

--29. Give the supplier ID, name, country and part name of foreign suppliers that provides parts to manufacturer. 
  
SELECT DISTINCT 
    S.SUPPLIER_ID, 
    S.SUPPLIER_NAME, 
    P.PART_NAME, 
    S.COUNTRY 
FROM  
    SUPPLIER S 
JOIN  
    SUPPLIES_PARTS SP ON S.SUPPLIER_ID = SP.SUPPLIER_ID 
JOIN  
    PARTS P ON SP.PART_ID = P.PART_ID 
JOIN  
    ORDER_FOR_PARTS OP ON P.PART_ID = OP.PART_ID 
WHERE  
    S.COUNTRY <> 'India'; 
 

--30. Calculate the manufacture cost (Base price) for every car model ,selling price to delear 
and also calculate the net profit. 
 
WITH AverageBasePrice AS ( 
    SELECT  
        dof.CAR_MODEL_ID, 
        AVG(dof.TOTAL_AMOUNT) AS sellstodelaer_price 
    FROM  
        DEALER_ORDER_FOR dof 
    GROUP BY  
        dof.CAR_MODEL_ID 
), 
TotalCostPerCarModel AS ( 
    SELECT  
        OB.CAR_MODEL_ID,  
        CM.MODEL_NAME,  
        CM.COLOR, 
        SUM(OT.TOTAL_AMOUNT) AS baseprice 
    FROM  
        ORDER_BASED_ON OB 
    JOIN  
        ORDER_TRANSACTIONS OT ON OB.ORDER_NO = OT.ORDER_NO 
    JOIN  
        CAR_MODEL CM ON OB.CAR_MODEL_ID = CM.CAR_MODEL_ID 
    GROUP BY  
        OB.CAR_MODEL_ID, CM.MODEL_NAME, CM.COLOR 
) 
SELECT  
    cm.CAR_MODEL_ID, 
    cm.MODEL_NAME, 
    cm.COLOR, 
    abp.sellstodelaer_price AS sellstodelaer_price, 
    tc.baseprice AS baseprice, 
    abp.sellstodelaer_price - tc.baseprice AS TOTAL_PROFIT 
FROM  
    CAR_MODEL cm 
JOIN  
    AverageBasePrice abp ON cm.CAR_MODEL_ID = abp.CAR_MODEL_ID 
JOIN  
    TotalCostPerCarModel tc ON cm.CAR_MODEL_ID = tc.CAR_MODEL_ID 
ORDER BY  
    cm.CAR_MODEL_ID;  
 

--31. Give the ID, name, color and paid amount of the car model that is the most expensive by model name to the dealer.
 
WITH MaxPricePerCarModel AS ( 
    SELECT  
        dof.CAR_MODEL_ID, 
        cm.MODEL_NAME, 
        cm.COLOR, 
        dof.TOTAL_AMOUNT, 
        ROW_NUMBER() OVER (PARTITION BY cm.MODEL_NAME ORDER BY dof.TOTAL_AMOUNT 
DESC) AS PRICE_RANK 
    FROM  
        DEALER_ORDER_FOR dof 
    JOIN  
        CAR_MODEL cm ON dof.CAR_MODEL_ID = cm.CAR_MODEL_ID 
) 
SELECT  
    CAR_MODEL_ID, 
    MODEL_NAME, 
COLOR, 
TOTAL_AMOUNT AS HIGHEST_PRICE_PAID_BY_DEALER 
FROM  
MaxPricePerCarModel 
WHERE  
PRICE_RANK = 1 
ORDER BY  
MODEL_NAME; 


--32.  Retrieve the insurance policies that have expired. 
SELECT IN_POLICY_NO, COMPANY_NAME, START_DATE, END_DATE 
FROM INSURANCE 
WHERE END_DATE < CURRENT_DATE; 


--33. Give the id and name of the car for which order of parts is not done yet. 
SELECT CM.CAR_MODEL_ID, CM.MODEL_NAME 
FROM CAR_MODEL CM 
LEFT JOIN ORDER_BASED_ON ob ON CM.CAR_MODEL_ID = ob.CAR_MODEL_ID 
WHERE ob.CAR_MODEL_ID IS NULL; 


--34. List the parts with their respective car models where the unit price of the part is above the average unit price of parts produced by the manufacturer. 
SELECT MP.COMPONENT_ID, MP.COMPONENT_NAME, MP.UNIT_PRICE, CM.CAR_MODEL_ID, 
CM.MODEL_NAME, 
(SELECT AVG(UNIT_PRICE) FROM MANUFACTURED_PARTS_BY_OWN) AS 
AVERAGE_UNIT_PRICE 
FROM MANUFACTURED_PARTS_BY_OWN MP 
JOIN CAR_MODEL CM ON MP.CAR_MODEL_ID = CM.CAR_MODEL_ID 
WHERE MP.UNIT_PRICE > ( 
SELECT AVG(UNIT_PRICE) 
FROM MANUFACTURED_PARTS_BY_OWN 
); 


--35. Find the total number of parts supplied by each supplier. 
SELECT S.SUPPLIER_ID, S.SUPPLIER_NAME, 
COUNT(SP.PART_ID) AS TOTAL_PARTS_SUPPLIED 
FROM SUPPLIER S 
LEFT JOIN SUPPLIES_PARTS SP ON S.SUPPLIER_ID = SP.SUPPLIER_ID 
GROUP BY S.SUPPLIER_ID, S.SUPPLIER_NAME; 
 
 
 
 
 
 
 
 
 